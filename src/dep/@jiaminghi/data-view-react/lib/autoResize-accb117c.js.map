{"version":3,"file":"autoResize-6a8eac7c.js","sources":["../src/use/autoResize.js"],"sourcesContent":["import { useState, useCallback, useEffect, useRef } from 'react'\r\nimport { debounce, observerDomResize } from '../util/index'\r\n\r\nexport default function useAutoResize() {\r\n  const [state, setState] = useState({ width: 0, height: 0 })\r\n\r\n  const domRef = useRef(null)\r\n  const domObserverRef = useRef(null)\r\n  const debounceSetWHFunRef = useRef(null)\r\n\r\n  const setWH = useCallback(() => {\r\n    const { clientWidth, clientHeight } = domRef.current\r\n\r\n    setState({ width: clientWidth, height: clientHeight })\r\n  }, [])\r\n\r\n  const bindDomResizeCallback = useCallback(() => {\r\n    domObserverRef.current = observerDomResize(\r\n      domRef.current,\r\n      debounceSetWHFunRef.current\r\n    )\r\n\r\n    window.addEventListener('resize', debounceSetWHFunRef.current)\r\n  }, [])\r\n\r\n  const unbindDomResizeCallback = useCallback(() => {\r\n    const { current: domObserver } = domObserverRef\r\n\r\n    domObserver.disconnect()\r\n    domObserver.takeRecords()\r\n    domObserverRef.current = null\r\n\r\n    window.removeEventListener('resize', debounceSetWHFunRef.current)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    debounceSetWHFunRef.current = debounce(setWH, 100)\r\n\r\n    debounceSetWHFunRef.current()\r\n\r\n    bindDomResizeCallback()\r\n\r\n    // 组件销毁时，清除事件\r\n    return unbindDomResizeCallback\r\n  }, [])\r\n\r\n  return { ...state, domRef }\r\n}\r\n"],"names":["useAutoResize","useState","width","height","state","setState","domRef","useRef","domObserverRef","debounceSetWHFunRef","setWH","useCallback","current","clientWidth","clientHeight","bindDomResizeCallback","observerDomResize","addEventListener","unbindDomResizeCallback","domObserver","disconnect","takeRecords","removeEventListener","debounce"],"mappings":";;;;;;;;;AAGe,SAASA,aAAT,GAAyB;kBACZC,eAAS,EAAEC,OAAO,CAAT,EAAYC,QAAQ,CAApB,EAAT,CADY;;MAC/BC,KAD+B;MACxBC,QADwB;;MAGhCC,SAASC,aAAO,IAAP,CAAf;MACMC,iBAAiBD,aAAO,IAAP,CAAvB;MACME,sBAAsBF,aAAO,IAAP,CAA5B;;MAEMG,QAAQC,kBAAY,YAAM;0BACQL,OAAOM,OADf;QACtBC,WADsB,mBACtBA,WADsB;QACTC,YADS,mBACTA,YADS;;;aAGrB,EAAEZ,OAAOW,WAAT,EAAsBV,QAAQW,YAA9B,EAAT;GAHY,EAIX,EAJW,CAAd;;MAMMC,wBAAwBJ,kBAAY,YAAM;mBAC/BC,OAAf,GAAyBI,wBACvBV,OAAOM,OADgB,EAEvBH,oBAAoBG,OAFG,CAAzB;;WAKOK,gBAAP,CAAwB,QAAxB,EAAkCR,oBAAoBG,OAAtD;GAN4B,EAO3B,EAP2B,CAA9B;;MASMM,0BAA0BP,kBAAY,YAAM;QAC/BQ,WAD+B,GACfX,cADe,CACxCI,OADwC;;;gBAGpCQ,UAAZ;gBACYC,WAAZ;mBACeT,OAAf,GAAyB,IAAzB;;WAEOU,mBAAP,CAA2B,QAA3B,EAAqCb,oBAAoBG,OAAzD;GAP8B,EAQ7B,EAR6B,CAAhC;;kBAUU,YAAM;wBACMA,OAApB,GAA8BW,eAASb,KAAT,EAAgB,GAAhB,CAA9B;;wBAEoBE,OAApB;;;;;WAKOM,uBAAP;GARF,EASG,EATH;;oCAWYd,KAAZ,IAAmBE,cAAnB;;;;;"}